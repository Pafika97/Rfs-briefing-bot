# RFS Briefing Watcher (RU)

Программа автоматически получает текст речи главы РФС (во время брифинга) и отправляет в телеграм‑чат краткие тезисы **пока брифинг ещё идёт**.

## Как работает (pipeline)
1) **Датчики источников**
   - `YouTube Live` — мониторит официальный канал **РФС ТВ** и ищет активные прямые эфиры.
     - Если у стрима есть **live‑субтитры**, они подгружаются через `youtube_transcript_api` (почти без задержки).
     - Если субтитров нет — берётся аудиопоток через `yt-dlp` и запускается локальная расшифровка **faster-whisper** (маленькая русская модель) с низкой задержкой.
   - `rfs.ru` — следит за публикацией стенограмм и статей с ключевыми словами («доклад», «брифинг», «итоги», «Дюков»). Как только выходит текст, забирает и добавляет в общую ленту.
2) **Очистка и нормализация текста** (удаление мусора, таймкодов).
3) **Мгновенное сжатие в тезисы** каждые 30–60 секунд из последнего окна речи (TF‑IDF + выделение ключевых предложений; для русского используются стоп‑слова).
4) **Отправка в Telegram**: заголовок события + 3–6 тезисов. Новые пункты не повторяют уже отправленные.

## Быстрый старт
1) Установите зависимости (Python 3.10+):
   ```bash
   python -m venv .venv && . .venv/bin/activate  # Windows: .venv\Scripts\activate
   pip install -r requirements.txt
   ```
2) Переименуйте `config.example.env` в `.env` и заполните:
   - `TELEGRAM_BOT_TOKEN` — токен бота
   - `TELEGRAM_CHAT_ID` — id вашего чата/канала
   - (опционально) `YOUTUBE_API_KEY` — для поиска активных трансляций
3) Запуск:
   ```bash
   python bot.py
   ```

## Ключевые файлы
- `bot.py` — точка входа; orchestration, отправка в Telegram.
- `sources/youtube_live.py` — поиск активного стрима РФС ТВ и получение текста (live‑субтитры или аудио‑STT).
- `sources/rfs_site.py` — парсер rfs.ru (новости/стенограммы).
- `transcribe/stream_stt.py` — low‑latency расшифровка через faster‑whisper (fallback, если нет субтитров).
- `summarize/summarizer.py` — извлечение тезисов из последнего окна речи.
- `requirements.txt` — зависимости.
- `run.sh` — пример запуска в screen/tmux.

## Примечания
- Для **минимальной задержки** используйте модель `faster-whisper` типа `small` или `medium` на CPU/GPU.
- Если YouTube отключит субтитры, fallback‑режим продолжит работать.
- Скрипт ориентирован на официальный канал: `РФС ТВ`.
- Соответствует требованиям: использовать транскрипты/видео и «другие онлайн‑источники» (официальный сайт с расшифровками).
